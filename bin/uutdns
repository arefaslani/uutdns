#!/usr/bin/env ruby
require 'optparse'
require 'uutdns'

$type = :standard
$ip
$domain
$server = "127.0.0.1"
$port = 53

# Parse command line optoions
OptionParser.new do |opts|
  opts.banner = "A simple DNS client built in Ruby written by Aref Aslani"
  opts.separator "options:"

  opts.on("--ip IP",
          "Gets the IP address as argument and returns domain name") do |ip|
    $type = :inverse
    $ip = ip
  end

  opts.on("--domain DOMAIN",
          "Gets the DOMAIN as argument and returens the IP address") do |domain|
    $type = :standard
    $domain = domain
  end

  opts.on("--server SERVER",
          "Gets DNS server ip address(default value is 127.0.0.1)") do |server|
    $server = server
  end

  opts.on("--port PORT",
          "Gets DNS server port number(default value is 53)") do |port|
    $port = port
  end
end.parse!

dns = UUTDNS.new
msg = dns.header($type) + dns.question($domain)

p msg